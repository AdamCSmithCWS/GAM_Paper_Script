# GAM_Paper_Script
Full code and models for paper describing a hierarchical Bayesian GAM for the BBS

Estimates of population change derived from the North American Breeding Bird Survey form the foundation of avian conservation in North America. The Canadian Wildlife Service (CWS, a division of Environment and Climate Change Canada) and the United States Geological Survey (USGS) produce national and regional status and trend estimates for 300-400 species of birds (Smith et al. 2019, Sauer et al. 2015). These estimates are derived from models designed to account for some of the sampling imperfections inherent to an international, long-term field survey, such as variations in which sites or routes are surveyed in a given year and variability among observers (Sauer and Link 2011, Smith et al. 2014). Producing these estimates requires significant analytical expertise, time, and computing resources, but the estimates are an invaluable resource that are used by many conservation organizations and researchers to visualize, analyze, and assess the population status of over 400 species of birds (e.g., Saracco et al. 2008, NABCI Canada 2019, NABCI U.S. 2014, Rosenberg et al. 2019, Stanton et al. 2019, Downes et al. 2017).
While the estimates of status and trend produced by the USGS and CWS are used for many different purposes, not all uses of the estimates are equally well supported by the standard models. This is not a criticism of the standard model, it is true of any particular model. Different conservation-based uses of the BBS status and trend estimates relate to different aspects of population change, including long-term trends, short-term trends, changes in population trends, or annual fluctuations, and no single model can estimate all parameters equally well (). For example, the standard models use Poisson regression slope-parameters and random year-effects in a hierarchical Bayesian framework (Sauer and Link 2011, Smith et al. 2014) to estimate population change. These slope and random year-effects are well suited to estimating annual fluctuations around a long-term change, but the model tends to be conservative when it comes to estimating changes in a species’ population trend, or population cycles (Fewster  et al. 2000, Smith et al. 2015, Amano et al. 2012). Similarly, short-term trends (e.g., the last 10-years of the time-series) derived from the standard models incorporate information from the entire time-series (i.e., the slope component of the model). This is a reasonable and useful assumption for data-sparse species and regions, which guards against extreme and imprecise fluctuations in short-term trends. However, for assessing changes in trends of a once-declining species (e.g., recovery of a species at risk), this feature of the model is problematic. 
GAMs provide a flexible framework for tracking changes in populations over time, without any assumptions about a particular pattern in population change. The slope parameter in the standard models estimates a constant rate of population change across the entire time-series, effectively assuming that there is some consistent rate of change. The random year-effects allow the population trajectory to depart from this consistent rate of change, but in situations of relatively sparse data in a given year and stratum the estimated population trajectory is shrunk back towards the long-term slope (). Similarly, the inclusion of the slope parameter in the standard model means that estimates of the rate of a species population change in the early portion of the time series (e.g., during the 1970s or 80s) will change over time in response to contemporary data and recent rates of population change. The random walk structure of a first-difference model (Link and Sauer 2017) assumes that the population in each year is similar to the population in the previous year—a biologically reasonable assumption—but if data are sparse, the population trends are shrunk towards zero. Conversely, GAM smooths are able to fit almost any shape of population trajectory, including stable populations, constant rates of increase or decrease, cycles of varying frequency and amplitude, or abrupt change points in population trends. In addition because of the separation of the time-series provided by the fixed knots in a GAM smooth, the addition of contemporary data has little or no influence on estimates of population change in the earlier portions of the time-series.
GAMs also provide a useful framework for sharing information on the shape and rate of population change across a species range. The GAM smoothing parameters can be estimated as random effects within geographic strata, thus allowing the model to share information on the shape of a species population trajectory across sub-regions of a species range. In the standard model, the slope parameters are also estimated as random effects, which improves estimates of trend for relatively data-sparse regions (). By contrast, the population change components of the first-difference model (Link and Sauer 2017) or a second-difference model (), include no way to share information on population change in space and so estimate population changes independently among strata. 
The inherently smooth temporal patterns generated by GAMs are well suited to particularly common conservation uses, such as assessments of trends in populations from any portion of a time-series as well as assessments of the rate of change in the trends over time. For example, the population trend criteria of the IUCN or COSEWIC assessments for endangered or threatened species, are based on rates of change over 3 generations. For most bird species monitored by the BBS, this 3-generation is approximately 10-years and so short-term trends are generally used. Because of the annual fluctuations estimated by the standard model and the end-point comparison used to estimate trends, these short-term trends can fluctuate from year to year, greatly complicating the quantitative assessment of a species trend in comparison to the regulatory thresholds. Species trends may surpass the threshold in one year, but not in the next. The same end-point comparisons on estimates from a GAM will only change gradually over time because of the lack of any annual fluctuations.
This paper describes a hierarchical GAM model to estimate the population status of birds using data from the BBS.



